<% content_for :before_content, govuk_back_link_to(previous_page, 'Back') %>
<% content_for :browser_title, title_with_error_prefix('Providers', @wizard.errors.any?) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= form_with model: @wizard, url: provider_interface_update_invitation_provider_permissions_path do |f| %>
      <%= f.govuk_error_summary %>

      <%= f.fields_for "provider_permissions[]", @permissions_form do |pf| %>
        <%= pf.hidden_field :provider_id %>
        <%
          fieldset_legend_text = 'Select permissions'
          fieldset_legend_text += ": #{@provider.name}" unless @wizard.single_provider
        -%>
        <%= pf.govuk_collection_check_boxes(
          :permissions,
          ProviderInterface::ProviderUserInvitationWizard::AVAILABLE_PERMISSIONS,
          :slug,
          :name,
          :hint,
          legend: { text: fieldset_legend_text, size: "xl" },
          caption: { text: "Edit user", size: "xl" },
        ) do %>
          <span id="permissions-hint" class="govuk-hint">
            The user will be able to view all applications made to courses at these organisations. You don't need to set permissions for this.
          </span>
        <% end %>
      <% end %>

      <%= f.govuk_submit 'Continue' %>
    <% end %>
  </div>
</div>
