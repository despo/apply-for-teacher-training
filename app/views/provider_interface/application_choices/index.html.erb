<% content_for :title, 'Applications' %>

<h1 class='govuk-heading-xl'>Applications</h1>
  <div class='moj-filter-layout'>

    <% if @page_state.filter_visible.eql?('true') %>
      <%= render ProviderInterface::FilterComponent, page_state: @page_state, providers: @providers %>
    <% end %>

    <%= render ProviderInterface::ToggleFilterComponent, page_state: @page_state %>
    <% if @application_choices.any? %>

      <div class='moj-filter-layout__content'>
        <div class='moj-scrollable-pane'>
          <div class='moj-scrollable-pane__wrapper'>
            <table class='govuk-table'>
              <thead class='govuk-table__head'>
                <tr class='govuk-table__row'>
                  <%= render ProviderInterface::SortableColumnHeadingComponent, column_name: 'Name', css_class: 'govuk-table__header govuk-!-width-one-quarter', page_state: @page_state %>
                  <%= render ProviderInterface::SortableColumnHeadingComponent, column_name: 'Course', css_class: 'govuk-table__header govuk-!-width-one-quarter', page_state: @page_state %>
                  <th scope='col' class='govuk-table__header govuk-!-width-one-quarter'>Status</th>
                  <%= render ProviderInterface::SortableColumnHeadingComponent, column_name: 'Last updated', css_class: 'govuk-table__header govuk-!-width-one-quarter govuk-table__header--numeric', page_state: @page_state %>
                </tr>
              </thead>

              <tbody class='govuk-table__body'>
                <% @application_choices.each do |application_choice| %>
                <tr class='govuk-table__row'>
                  <th class='govuk-table__cell'><%= govuk_link_to application_choice.application_form.full_name, provider_interface_application_choice_path(application_choice) %></th>
                  <td class='govuk-table__cell'>
                    <% if current_provider_user.providers.size > 1 %>
                      <span class='govuk-caption-m govuk-!-font-size-16'>
                        <%= application_choice.provider.name %>
                      </span>
                    <% end %>

                    <%= application_choice.course.name_and_code %></td>
                  <td class='govuk-table__cell'><%= render ProviderInterface::ApplicationStatusTagComponent, application_choice: application_choice %></td>
                  <td class='govuk-table__cell govuk-table__header--numeric'><%= application_choice.updated_at.to_s(:govuk_date_short_month) %></td>
                </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    <% elsif @page_state.filter_options.any? %>
       <p class='govuk-body'>No applications for the selected filters.</p>
    <% else %>
      <p class='govuk-body'>You havenâ€™t received any applications from <%= t('service_name.apply') %>.</p>
    <% end %>

</div>
