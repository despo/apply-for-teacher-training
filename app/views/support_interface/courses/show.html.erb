<% content_for :context, @course.provider.name_and_code %>
<% content_for :title, @course.name_and_code %>
<% content_for :before_content, govuk_back_link_to(support_interface_provider_path(@course.provider), 'Back to provider') %>

<h2 class='govuk-heading-m'>Course info</h2>

<%= render(SummaryCardComponent.new(rows: {
  'Name' => @course.name_and_code,
  'Provider' => govuk_link_to(@course.provider.name_and_code, support_interface_provider_path(@course.provider)),
  'Accredited body' => @course.accredited_provider&.name_and_code || 'None',
  'Level' => @course.level.humanize,
  'Recruitment cycle year' => @course.recruitment_cycle_year,
  'Last updated' => @course.updated_at.to_s(:govuk_date_and_time),
  'Study modes' => @course.study_mode.humanize,
  'Funding type' => Course.human_attribute_name("funding_type.#{@course.funding_type}"),
  'Info page' => govuk_link_to('View on Find', @course.find_url),
  'Start on Apply' => govuk_link_to('View on Apply (candidate)', candidate_interface_apply_from_find_path(providerCode: @course.provider.code, courseCode: @course.code)),
})) %>

<h2 class='govuk-heading-m'>Settings</h2>

<%= render(SummaryCardComponent.new(rows: {
  'Exposed in Find' => @course.exposed_in_find? ? 'Yes' : 'No',
  'Open on Apply' => @course.open_on_apply? ? 'Yes' : 'No',
})) %>

<%= form_with model: @course, url: support_interface_course_path(@course), method: :post do |f| %>
  <%= f.govuk_error_summary %>

  <%= f.govuk_radio_buttons_fieldset :open_on_apply, legend: { size: 'm', text: 'Can candidates use Apply?' } do %>
    <%= f.govuk_radio_button :open_on_apply, true, label: { text: 'Yes, this course is available on Apply and UCAS' }, link_errors: true %>
    <%= f.govuk_radio_button :open_on_apply, false, label: { text: 'No, this course is only available on UCAS' } %>
  <% end %>

  <%= f.govuk_submit 'Save' %>
<% end %>
